type: npm
apiVersion: 1.6.97
pipelineAdministrators:
  - '868562'
  - '856105'
  - '050904'
container:
  image: artifacts.aa.com/docker-prod/edots-base-jdk11:3.11.9
integrationBranches:
  - '*'
provider:
  azure:
    azurerm: 
      resource_group_name: cstrm-n-statusboard-rg
      storage_account_name: tfstatusboarlhj3v42l
      container_name: tfstate

env:
  variables:
    ARM_SKIP_PROVIDER_REGISTRATION: true

deployInfra: yamlit_terraform
deployApp: appservice

CI:
 post:
    - name: 'linting and style'
      steps: |
        sh 'npm run lint'
        sh 'npm run checkstyle'
        sh 'npm run build'

CD:
  deployments:
    dev:
      servicePrincipalCredJenkins: service_principal_nonprod
      app:
        - name: statusboard-dev
          resourceGroup: cstrm-n-statusboard-rg 
      sourceBranches:
        - '*'
      subscription: aa-cstrm-spoke
